let ajaxutils={basegetmethod:function(a){return new Promise(function(t,e){$.ajax({url:a.url,headers:a.getauth,method:"GET",dataType:"json",success:function(a){t(a)},error:function(a){e(a)}})})},basepostmethod:function(a){return new Promise(function(t,e){$.ajax({type:"POST",url:a.url,headers:a.postauth.headers,dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify(a.payload),success:function(a){t(a)},error:function(a){console.log(a),e(a)}})})},basepostmethodrawbody:function(a){return new Promise(function(t,e){$.ajax(a.url,{headers:a.postauth.headers,type:"POST",processData:!1,data:JSON.stringify(a.payload),contentType:"multipart/form-data",success:function(a){t(a)},error:function(a){console.log(a),e(a)}})})}};$(function(){baseloadsegments.populateaxiskeys(),htmlpopulate.htmlpopulatetableheader(),htmlpopulate.htmlpopulatemodal(),$("#tooglecheck1 input").change(function(){$(this).is(":checked")?($(this).next().text("without consolidated"),renderall()):(renderconsolidated(),$(this).next().text("consolidated result"))}),$("#tooglecheck6 input").change(function(){$(this).is(":checked")?($(this).next().text("dark theme ON"),darkMode()):($(this).next().text("dark theme OFF"),lightMode())}),iconsload(),$("#tooglecheck2 input").change(function(){$(this).is(":checked")?($(this).next().text("without consolidated"),renderall3d()):(renderconsolidated3d(),$(this).next().text("consolidated result"))}),$('.form-horizontal input:text ,[data-attribute="date"]').on("keydown keyup change",function(){$("#overlaycontent *[data-form-type]").length<=0?$("#btnmodalsub").prop("disabled",!1):$("#btnmodalsub").prop("disabled",!0)})});let reqops={uploadFile:function(a){return new Promise(function(t,e){var i=baseurlobj.uploaddata,n=new XMLHttpRequest,s=new FormData;n.open("POST",i,!0),n.onreadystatechange=function(){4==n.readyState&&200==n.status&&t(n.responseText)},s.append("upload_file",a),n.setRequestHeader("x-access-token",customToken),n.send(s)})},flpupload:function(){$("#uploadfiles").click()},clearControls:function(){for(var a=document.getElementsByClassName("modal-content")[0].getElementsByTagName("input"),t=0;t<a.length;t++)"text"!=a[t].type&&"date"!=a[t].type||(a[t].value="");$("#cltrlrecordstate").prop("checked",!1),$("#overlaycontent .selectchips").remove(),$("#overlaycontent .form-group.overlaytxtalign.col-md-5 .custom-control.custom-radio ").each(function(a){$(this).find('[type="radio"]').prop("checked",!1)}),$('#overlaycontent *[data-attribute="checkboxMulti"]').each(function(a){$(this).prop("checked",!1)}),basemod_modal.customClearControl()},fileSelected:function(a){var t=a.files[0];reqops.uploadFile(t).then(function(a){$("#uploadfiles").val(""),$("#uploadsave").show(),$("#uploadsavemsg").show(),$("#notificationsid").show(),$("#uploadsavemsg").html("Data processing in progress !"),setintervalparams.id=setInterval(function(){setintervalparams.width>=24263?clearInterval(setintervalparams.id):(setintervalparams.width++,$("#lbluploadprogress").html(setintervalparams.width+"%"),$("#dvuploadprogress").css("width",setintervalparams.width+"%"),$("#uploadsave").show(),$("#uploadsave").html(setintervalparams.width+"%"))},750)})},consolidatesearch:function(){base.searchtype="consolidatesearch",base.idstatus=!0,base.excludedatecol=!0;var a=applyfields,t={};basesearcharconsolidated=[],t.consolidatecol=a,t.consolidatecolval=$("#txtconsolidatesearch").val().trim(),basesearcharconsolidated.push(t),base.datapayload=payloadprepared(),basefunction().getpaginatesearchtype(base).then(function(a){htmlpopulate.htmlpopulatetable(a),basepagination.bootpagination(a),htmlpopulate.highlightconsolidatesearch(),$("#dvreportcontainer").hasClass("collapsed-box")&&$("#rptwidget").click(),basefunction().getpaginatesearchtypeCount(base).then(function(a){htmlpopulate.htmltablecount(a)})})},ontdedit:function(a){ajaxbase.isedit=!0;var t=ajaxbase.response.rows;t=t.filter(function(t){return t[currentmoduleid]==a}),Object.keys(t[0]).map(function(a,e){var i=t[0][a];"date"==validationmap.filter(t=>t.inputname===a).map(a=>a.fieldvalidatename).toString()&&(i=moment(i).format("YYYY-MM-DD")),$("#cltrl"+a).val(i),$("#cltrl"+a).removeAttr("data-form-type")}),1==t[0].recordstate?($("#cltrlrecordstate").prop("checked",!0),base.interimdatapayload.recordstate=!0):($("#cltrlrecordstate").prop("checked",!1),base.interimdatapayload.recordstate=!1),$("#btnbutton").click()},extractDatafromfields:function(){let a={};return validationmap.forEach(function(t){a[t.inputname]=$(`[data-key-type="${t.inputname}"]`).val()}),a},btnSubmit:function(){data=this.extractDatafromfields(),ajaxbase.isedit?(data[currentmoduleid]=$("#cltrl"+currentmoduleid).val(),base.datapayload=data,base.datapayload.recordstate=void 0==base.interimdatapayload.recordstate?base.datapayload.recordstate:base.interimdatapayload.recordstate,basefunction().update(base).then(function(a){baseloadsegments.initialdatatableload(),reqops.clearControls(),$("#btnmodalclose").click()})):(delete data[currentmoduleid],base.datapayload=data,base.datapayload.recordstate=base.interimdatapayload.recordstate,basefunction().insert(base).then(function(a){baseloadsegments.initialdatatableload(),reqops.clearControls(),$("#btnmodalclose").click()}))},exportexcel:function(){base.datapayload=payloadprepared(),basefunction().exportexcel(base).then(function(a){$("#uploadfiles").val(""),$("#uploadsave").show(),$("#uploadsavemsg").show(),$("#notificationsid").show(),$("#uploadsavemsg").html("Preparing for download !"),setintervalparams.id=setInterval(function(){setintervalparams.width>=24263?clearInterval(id):(setintervalparams.width++,$("#lbluploadprogress").html(setintervalparams.width+"%"),$("#dvuploadprogress").css("width",setintervalparams.width+"%"),$("#uploadsave").html(setintervalparams.width+"%"))},750)})},srchparams:function(){base.searchtype="Columnwise",base.datapayload=payloadprepared(),basefunction().getpaginatesearchtype(base).then(function(a){htmlpopulate.htmlpopulatetable(a),basepagination.bootpagination(a),$("#dvreportcontainer").hasClass("collapsed-box")&&$("#rptwidget").click(),basefunction().getpaginatesearchtypeCount(base).then(function(a){htmlpopulate.htmltablecount(a)})})}},basepagination={bootpagination:function(a){$("#page-selection").unbind("page"),$("#page-selection").empty();var t=$("#inppagesize").val(),e=a.count,i=a.count<=100?Math.round(e/t):5;i>0&&$("#page-selection").bootpag({page:1,total:e,maxVisible:i,leaps:!0}).on("page",this.bootpagescallback)},bootpagescallback:function(a,t){return base.pageno=t-1,baseloadsegments.initialdatatableload(),!1},bootpaginationxaxis:function(a){$("#page-selection-xaxis").unbind("page"),$("#page-selection-xaxis").empty(),$("#page-selection-xaxis").bootpag({page:1,total:a.Xtotalpivotrecorset,maxVisible:5,leaps:!0}).on("page",this.bootpagescallbackxaxis)},bootpagescallbackxaxis:function(a,t){base.Xpageno=t,base.pivotinternload=!1,pivotutils.pivotreport()},bootpaginationyaxis:function(a){$("#page-selection-yaxis").unbind("page"),$("#page-selection-yaxis").empty(),$("#page-selection-yaxis").bootpag({page:1,total:a.Ytotalpivotrecorset,maxVisible:5,leaps:!0}).on("page",this.bootpagescallbackyaxis)},bootpagescallbackyaxis:function(a,t){base.Ypageno=t,base.pivotinternload=!1,pivotutils.pivotreport()}},tableops={tblchkall:function(){$("#msgchksptotalUsers").html("clear selection"),base.tblchk?(this.unchecktblall(),base.tblchk=!1,base.pageSize=base.internpageSize):(base.tblchk=!0,this.clearfieldselection(),base.internpageSize=base.pageSize,base.pageSize=parseInt($("#sptotalUsers").html()))},tablechkbox:function(a){var t=selectArr.indexOf(a);-1==t?selectArr.push(a):(selectArr.splice(t,1),multiselect.removefilterdiv(this,currentmoduleid,a)),selectArr.forEach(function(a){multiselect.assignsearchparams(currentmoduleid,a)})},clearfieldselection:function(){basesearchar=basesearchar.filter(function(a){return!Object.keys(a).includes(currentmoduleid)})},unchecktblall:function(){$("#tblchkmsg").hide(),$(".tblkchk").prop("checked",!1),selectArr=[],$("#tblselectallchk").prop("checked",!1),base.pageSize=base.internpageSize,base.tblchk=!1,this.clearfieldselection()},tblselectall:function(){$("#tblselectallchk").prop("checked")?($(".tblkchk").prop("checked",!0),$("#tblchkmsg").show(),$("#msgsppageSize").html($("#sppageSize").html()),$("#msgchksptotalUsers").html($("#sptotalUsers").html()),$(".tblkchk").each(function(){var a=$(this).data().chkType;selectArr=[],tableops.tablechkbox(a)})):($(".tblkchk").prop("checked",!1),$("#tblchkmsg").hide(),selectArr=[])},sort:function(a){var t=$(a).attr("data-field-header");$(a).find("span").toggleClass("sortorderdesc sortorderasc"),$(a).find("span").hasClass("sortorderdesc")?this.dynamicsorting(t,!0):this.dynamicsorting(t,!1)},dynamicsorting:function(a,t){var e=1==t?"DESC":"ASC";filterparam.sortcolumn=a,filterparam.sortcolumnorder=e,base.pageno=0,filterparam.pageno=base.pageno,filterparam.pageSize=base.pageSize,filterparam.ispaginate=!0,base.datapayload=filterparam,basefunction().getpaginatesearchtype(base).then(function(a){htmlpopulate.htmlpopulatetable(a),basefunction().getpaginatesearchtypeCount(base).then(function(a){htmlpopulate.htmltablecount(a)})})},onchk:function(a){$(a).prop("checked")?($(a).val(!0),base.interimdatapayload.recordstate=!0):($(a).val(!1),base.interimdatapayload.recordstate=!1),reqopsValidate.formvalidation(a)}};function payloadprepared(){return filterparam.colsearch="intercolumn",filterparam.searchparam=basesearchar,base.tblchk?(base.pageno=0,void 0==base.pageSize&&(base.pageSize=20),filterparam.ispaginate=!0):(filterparam.ispaginate=!1,base.pageno=0),filterparam.pageno=base.pageno,filterparam.pageSize=base.pageSize,filterparam.pivotparamXaxis=base.pivotparamXaxis,filterparam.pivotparamYaxis=base.pivotparamYaxis,filterparam.timeinternprimary=base.timeinternprimary,filterparam.timeinternsecondary=base.timeinternsecondary,filterparam.XpageSize=base.XpageSize,filterparam.Xpageno=base.Xpageno,filterparam.YpageSize=base.YpageSize,filterparam.Ypageno=base.Ypageno,filterparam.searchtype=base.searchtype,filterparam.datecolsearch=base.datecolsearch,filterparam.basesearcharconsolidated=basesearcharconsolidated,filterparam.sortcolumn=1,filterparam.sortcolumnorder="desc",filterparam}$(document).on("keyup",function(a){"Escape"==a.key&&validationmap.forEach(function(a){$("#dv_"+a.inputname+" ").html(" "),$("#dv_"+a.inputname+" ").hide(),$("#cltrl_filter_"+a.inputname).val("")})});let htmlPopulateCustomControl={multiCheckBoxPopulate:function(a,t){return`<div class="custom-control custom-checkbox">\n    <label><input type="checkbox" class="custom-control-input" id="cltrl${t.id}${a[t.id]}" \n    onclick="javascript:basemod_modal.on${t.name}Control(this)" \n    data-key="${t.id}"j\n    data-val="${a[t.id]}"\n    data-attribute="checkboxMulti"\n    data-parentVal="${t.name}"       \n    value="${a[t.id]}">${a[t.text]}\n    </label></div>`},validationListener:function(){var a=$("#overlaycontent input:text[data-form-type], input:checkbox[data-form-type], div[data-form-type]").length;console.log(a),a<=0?$("#btnmodalsub").prop("disabled",!1):$("#btnmodalsub").prop("disabled",!0)},multiCheckboxPopulatePrimary:function(a,t){return`<div class="form-group overlaytxtalign col-md-5" data-attribute="checkboxMulti"  data-form-type="true">\n    <div class="col-sm-15">\n           <label class="lblhide" id="lblmsg${a.id}">\n           <i class="fa fa-bell-o"></i> Please select gender\n           </label>${t}</div>\n           </div></div>`},genericCheckboxHtml:function(a){return`<input type="hidden" name="${a}" value="0" id="cltrl${a}"> \n    <div class="form-group overlaytxtalign col-md-5"><div class="col-sm-offset-2 col-sm-15"><div><label><div class="checkbox tablechk">\n   <label>\n   <div class="col-sm-15">\n                    <label class="lblhide" id="lblmsgrecordstate">\n                    <i class="fa fa-bell-o"></i> Please select Active\n                    </label>\n   <input type="checkbox" id="cltrlrecordstate" data-attribute="checkbox" data-form-type="true" onclick="javascript:tableops.onchk(this)" value="true"><span class="checkbox-material"><span class="check"></span></span> Remember me\n   <span class="checkbox-material">\n   </div>\n   </span> \n   </label>\n   </div></label></div></div></div>`},genericCheckboxHtmlPrimary:function(){return'<div class="checkbox tablechk">\n   <label>\n   <input type="checkbox" id="cltrlrecordstate" data-form-type="true" data-attribute="radio"  onclick="javascript:tableops.onchk(this)" value=true> Remember me\n   <span class="checkbox-material">\n   </span> \n   </label>\n   </div>'},genericRecordState:function(a,t){a[0].recordstate?($("#cltrlrecordstate").prop("checked",!0),$("#cltrlrecordstate").val(!0),t.datapayload.recordstate=!0,t.interimdatapayload.recordstate=!0,$("#cltrlrecordstate").removeAttr("data-form-type")):($("#cltrlrecordstate").prop("checked",!1),$("#cltrlrecordstate").val(!1),t.datapayload.recordstate=!1,t.interimdatapayload.recordstate=!1),$("#btnbutton").click()},textBoxPopulateSecondary:function(a){return`<div class="form-group overlaytxtalign col-md-5">\n    <div class="col-sm-15">\n    <label class="lblhide" id="lblmsg${a.inputname}">\n    <i class="fa fa-bell-o"></i>  ${a.inputname} is required\n    </label>\n    <input type="text" data-attribute="${a.fieldvalidatename}" class="form-control" maxLength="${a.fieldmaxlength}"\n    data-form-type="false" onkeyup="javascript:reqopsValidate.formvalidation(this)" id="cltrl${a.inputname}" placeholder="${a.inputplaceholder.capitalize()}">\n    </div></div>`},genericddlPopulate:function(a){return`<div class="form-group col-sm-6"> \n      <div class="col-sm-15">\n      <label class="lblhide" id="lblmsgddlddlmulti">\n      <i class="fa fa-bell-o"></i> Please Select ${a.inputCustomMapping} \n      </label>\n      <div onkeyup="javascript:reqopsValidate.formvalidation(this)" data-attribute="multiSelect"\n      data-key="${a.inputname}" data-form-type="false" id="in${a.inputtextval}"></div>\n      </div></div>`},customRadioPopulate:function(a,t){return`<div class="custom-control custom-radio">\n      <label><input type="radio" class="custom-control-input" id="cltrl${t.id}${a[t.id]}" \n      onclick="javascript:basemod_modal.on${t.name}Control(this)" \n      data-key="${t.id}"\n      name="customRadio${t.name}"\n      data-val="${a[t.id]}"  \n      value="${a[t.id]}">${a[t.text]}\n      </label></div>`},customRadioPopulatePrimary:function(a,t){return`<div class='form-group overlaytxtalign col-md-5' onclick="javascript:reqopsValidate.formvalidation(this)" data-attribute="radio" data-form-type="true">\n      <div class="col-sm-15">\n                    <label class="lblhide" id="lblmsg${a.id}">\n                    <i class="fa fa-bell-o"></i> Please select gender\n                    </label>\n      ${t}</div></div>`},genericMultiControlpayload:function(a,t,e,i){var n={recordstate:a.interimdatapayload.recordstate};let s={...Object.fromEntries(Object.entries(t.datapayload).map(([a,t])=>[a,datatransformutils.flat(t)])),...n};var o=datatransformutils.getCartesian(s);if(console.log(ajaxbase.isedit),ajaxbase.isedit){return console.log(e),e.forEach(function(t,e){void 0==o[e]?(a.datapayload={delObj:{[i]:t}},basefunction().deleterecord(a).then(function(a){})):o[e][i]=t}),o.forEach(function(t,e){Object.keys(t).includes(i)||(a.datapayload=t,basefunction().singleInsert(a).then(function(a){}),delete o[e])}),a.datapayload=o.filter(Boolean),a}{let t={payset:o};return a.datapayload=t,a}}};String.prototype.capitalize=function(){return this.replace(/(^|\s)([a-z])/g,function(a,t,e){return t+e.toUpperCase()})};let multiselect={searchbarautocomplete:function(a){let t={},e=[],i=$(a).val(),n=$(a).data("multipleselect-autocomplete"),s=$(a).data("multipleselect-autocomplete-key");this.appendautopopulate(a,s),a.position=n,t[n]=i.toLowerCase();let o=[];e.push(t),basesearchar.length>0&&(o.push(basesearchar),o=datatransformutils.removeJsonAttrs(o[0],[s]),o=0==Object.keys(o[0]).length?[]:o),filterparam.pageno=0,filterparam.pageSize=20,filterparam.searchtype="Columnwise",filterparam.searchparam=e,filterparam.searchparamkey=s,o=o.filter(a=>0!==Object.keys(a).length),filterparam.searchparammetafilter=o,filterparam.ispaginate=!0,base.datapayload=filterparam;var r=basesearchar;basefunction().getpaginatesearchtypegroupby(base).then(function(a){$("#dv_"+s+" ").html(" "),$("#dv_"+s+" ").hide();let t=a.rows;if(r.length>0){var e=r.map(function(a){return a[s]})[0];void 0!=e?t=t.filter(a=>!e.includes(a[s].toString().toLowerCase())):(console.log(t),console.log("something is undefined "))}let i="";t.forEach(function(a){i+='<div><a class="highlightselect" href=\'javascript:multiselect.onsearchtext("'+s+'","'+a[n].toString().toLowerCase()+'","'+a[s].toString().toLowerCase()+"\");'>"+a[n]+"  </a></div>"});$("#dv_"+s).html(i),$("#dv_"+s).show()}).catch(function(a){console.log(a)})},appendautopopulate:function(a,t){$('<div id="cltrl_filter_chips_'+t+'"></div><div id="dv_'+t+'" class="srchpara"></div>').insertAfter($(a))},onsearchtext:function(a,t,e){$("#dv_"+a).html(" "),$("#dv_"+a).hide(),$("#cltrl_filter_"+a).val(""),this.assignsearchparams(a,e),$("#cltrl_filter_chips_"+a).append('<div class="selectchips"><span ID="cltrl_filter_span_'+a+'" onclick=\'javascript:multiselect.removefilterdiv(this,"'+a+'", "'+e+'");\' class="select2choiceremove" role="presentation">×</span>'+t.capitalize()+"</div>")},assignsearchparams:function(a,t){var e=[];if(isNaN(t)?(t=t.toLowerCase(),e.push(t)):e.push(t),basesearchar.filter(function(t){return void 0!=t[a]}).length>0){var i=basesearchar;i=i.filter(function(t){return void 0!=t[a]}).map(function(e){return{[a]:e[a].concat(t)}}),this.updateNameById(basesearchar,a,i[0][a])}else basesearchobj[a]=e,basesearchar.push(basesearchobj),basesearchobj={}},removefilterdiv:function(a,t,e){$(a).parent().remove();var i=basesearchar;i=i.filter(function(a){return void 0!=a[t]}).map(function(a){return{[t]:a[t].remByVal(e)}}),this.updateNameById(basesearchar,t,i[0][t]),i[0][t].length<=0&&(basesearchar=datatransformutils.removeJsonAttrs(basesearchar,[t])),basesearchar=basesearchar.filter(a=>0!==Object.keys(a).length)},fieldfilters:function(a){$(a).children().hasClass("fa-plus")?($(".fieldsfilterbar").slideToggle(300),$(a).children().removeClass("fa-plus").addClass("fa-minus")):($(".fieldsfilterbar").slideToggle(300),$(a).children().removeClass("fa-minus").addClass("fa-plus"))},updateNameById:function(a,t,e){Object.keys(a).some(function(i){if(void 0!=a[i][t])return a[i][t]=e,!0})},removeFromArray:function(a,t){var e=basesearchar;e=e.filter(function(t){return void 0!=t[a]}).map(function(e){return{[a]:e[a].remByVal(t)}}),this.updateNameById(basesearchar,a,e[0][a]),basesearchar=basesearchar.filter(a=>0!==Object.keys(a).length)}},selectArr=[],basesearchobj={},basesearchar=new Array,basesearcharconsolidated=new Array,basedataset={},base={appkey:location.hostname+(location.port?":"+location.port:""),config:{headers:{"x-access-token":customToken}},timeinternprimary:"Month",timeinternsecondary:"Month",XpageSize:40,Xpageno:0,YpageSize:20,Ypageno:0,pivotinternload:!0,searchtype:"NoFilter",interimdatapayload:{}},ajaxurl={auth:"/getToken"},ajaxbase={postauth:base.config},setintervalparams={width:1,id:""},host=location.protocol.concat("//").concat(window.location.hostname),socket=io.connect();socket.on("news",function(a){new Date;clearInterval(setintervalparams.id);var t=setintervalparams.width,e=setInterval(function(){101===++t?(clearInterval(e),t=0,setintervalparams.width=0,$("#uploadsavemsg").html(a+" records are inserted ! ")):($("#lbluploadprogress").html(t+"%"),$("#dvuploadprogress").css("width",t+"%"),$("#uploadsave").html(t+"%"))},20)}),socket.on("newsdownloadsets",function(a){var t=a.replace(".csv","");clearInterval(setintervalparams.id);var e=setintervalparams.width,i=setInterval(function(){101===++e?(clearInterval(i),e=0,setintervalparams.width=0,$("#libasenotifications").hide(),$("#libasenotificationrow").show(),$("#spn_dv"+t).hide(),$("#dv_set_progress"+t).before('<a href="../exportCsv/'+a+'"><i class="fa fa-download text-aqua"></i> <span  style="white-space: normal !important;">'+a+"</span></a>"),$("#uploadsave").hide()):($("#uploadsave").show(),$("#lbluploadprogress"+t).html(e+"%"),$("#dvuploadprogress"+t).css("width",e+"%"),$("#uploadsave").html(e+"%"))},20)}),socket.on("newsdownload",function(a){socket.emit("end")}),socket.on("newsdownloadsetprogressstats",function(a){$("#libasenotifications").hide(),$("#libasenotificationrow").show();var t=a.filenames,e=a.count<=0?40:parseInt(a.count);$("#libasenotificationrow").append('<span style="color: #28669c;" id="spn_dv'+t+'">Data processing in progress !</span><div id="dv_set_progress'+t+'"><small class="pull-right"><label id="lbluploadprogress'+t+'">%</label></small><div class="progress xs"><div class="progress-bar progress-bar-aqua" id="dvuploadprogress'+t+'" style="width: 20%;" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div></div><div class="ripple-container"><div class="ripple ripple-on ripple-out" style="left: 205.203px; top: 42px; background-color: rgb(33, 150, 243); transform: scale(32.875);"></div></div></div>'),clearInterval(setintervalparams.id),setintervalparams.id=setInterval(function(){setintervalparams.width>=e?(clearInterval(id),setintervalparams.width=0):(setintervalparams.width++,$("#lbluploadprogress"+t).html(setintervalparams.width+"%"),$("#dvuploadprogress"+t).css("width",setintervalparams.width+"%"),$("#uploadsave").html(setintervalparams.width+"%"))},750),setintervalparams.width=0}),socket.on("newsrecordset",function(a){$("#uploadnotification").html(a)});let validations={string:[/^[a-zA-Z ]+$/,"Please enter valid  name"],number:[/^[0-9]+$/,"Please enter valid number"],email:[/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/,"Please enter a valid email address"],mobile:[/^(\+\d{1,3}[- ]?)?\d{10}$/,"Please enter a valid mobile number"],password_set1:[/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/,"Please enter Minimum eight characters, at least one letter and one number"],password_set2:[/^(?=.*[A-Za-z])(?=.*\d)(?=.*[$@$!%*#?&])[A-Za-z\d$@$!%*#?&]{8,}$/,"Please enter Minimum eight characters, at least one letter, one number and one special character"],password_set3:[/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/,"Please enter Minimum eight characters, at least one uppercase letter, one lowercase letter and one number"],password_set4:[/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[$@$!%*?&])[A-Za-z\d$@$!%*?&]{8,}/,"Please enter Minimum eight characters, at least one uppercase letter, one lowercase letter, one number and one special character"],password_set4:[/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[$@$!%*?&])[A-Za-z\d$@$!%*?&]{8,10}/,"Please enter Minimum eight and maximum 10 characters, at least one uppercase letter, one lowercase letter, one number and one special character"],date:[/^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]|(?:Jan|Mar|May|Jul|Aug|Oct|Dec)))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2]|(?:Jan|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec))\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)(?:0?2|(?:Feb))\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9]|(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep))|(?:1[0-2]|(?:Oct|Nov|Dec)))\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/,"Please enter valid date"],alphaNumeric:[/^[a-z0-9]+$/i,"Please enter Valid Alpha numeric String"],showCSS:"control-label-format",hideCSS:"lblhide",hideCSSlbl:"lblhide"},reqopsValidate={formvalidation:function(a){var t=$(a).attr("data-attribute"),e={};e.content=a,e.contenttype=t,baseobjvalidation.validationinterface(e)}};var baseobjvalidation={emailvalidation:function(a){validation=new RegExp(validations.email[0]),validation.test(a.value)?($(a).parent().find("label").attr("class",validations.hideCSS),$(a).removeAttr("data-form-type")):($(a).parent().find("label").attr("class",validations.showCSS),$(a).attr("data-form-type","true")),this.validationListener()},numbervalidation:function(a){validation=new RegExp(validations.number[0]),validation.test(a.value)?($(a).parent().find("label").attr("class",validations.hideCSS),$(a).removeAttr("data-form-type")):($(a).parent().find("label").attr("class",validations.showCSS),$(a).attr("data-form-type","true")),this.validationListener()},mobilevalidation:function(a){validation=new RegExp(validations.mobile[0]),validation.test(a.value)?($(a).parent().find("label").attr("class",validations.hideCSS),$(a).removeAttr("data-form-type")):($(a).parent().find("label").attr("class",validations.showCSS),$(a).attr("data-form-type","true")),this.validationListener()},passwordvalidation:function(a){validation=new RegExp(validations.password_set1[0]),validation.test(a.value)?($(a).parent().find("label").attr("class",validations.hideCSS),$(a).removeAttr("data-form-type")):($(a).parent().find("label").attr("class",validations.showCSS),$(a).attr("data-form-type","true")),this.validationListener()},textvalidation:function(a){validation=new RegExp(validations.string[0]),validation.test(a.value)?($(a).parent().find("label").attr("class",validations.hideCSS),$(a).removeAttr("data-form-type")):($(a).parent().find("label").attr("class",validations.showCSS),$(a).attr("data-form-type","true")),this.validationListener()},alphaNumericValidation:function(a){validation=new RegExp(validations.alphaNumeric[0]),validation.test(a.value)?($(a).parent().find("label").attr("class",validations.hideCSS),$(a).removeAttr("data-form-type")):($(a).parent().find("label").attr("class",validations.showCSS),$(a).attr("data-form-type","true")),this.validationListener()},checkboxvalidation:function(a){$(a).is(":checked")?($(a).parent().find("label").attr("class",validations.hideCSS),$(a).removeAttr("data-form-type")):($(a).parent().find("label").attr("class",validations.showCSS),$(a).attr("data-form-type","true")),this.validationListener()},validationListener:function(){$("#overlaycontent *[data-form-type]").length<=0?$("#btnmodalsub").prop("disabled",!1):$("#btnmodalsub").prop("disabled",!0)},checkboxvalidationMulti:function(a){$(a).is(":checked")?($(a).parents(":eq(2)").find(`.${validations.showCSS}`).attr("class",validations.hideCSSlbl),$(a).parents(":eq(4)").find(".form-group").removeAttr("data-form-type")):this.checkboxvalidationSecondary(a)&&($(a).parents(":eq(2)").find(`.${validations.hideCSSlbl}`).attr("class",validations.showCSS),$(a).parents(":eq(4)").find(".form-group").attr("data-form-type","true"))},checkboxvalidationSecondary:function(argument){var namesake=`current${$(argument).attr("data-parentVal")}`,condt=eval(namesake).data[$(argument).attr("data-key")].length;return condt<=0},radiovalidation:function(a){$(a).removeAttr("data-form-type"),this.validationListener()},datevalidation:function(a){validation=new RegExp(validations.date[0]),validation.test(a.value)||""==a.value?($(a).parent().find("label").attr("class",validations.showCSS),$(a).attr("data-form-type","true")):($(a).parent().find("label").attr("class",validations.hideCSS),$(a).removeAttr("data-form-type"))},genvalidation:function(a){""==a.value?($(a).parent().find("label").attr("class",validations.hideCSS),$(a).removeAttr("data-form-type")):($(a).parent().find("label").attr("class",validations.showCSS),$(a).attr("data-form-type","true"))},multiSelectValidation:function(a){var t=$(a).attr("data-key");Array.isArray(multiselects[t])&&multiselects[t].length?($(a).parent().find("label").attr("class",validations.hideCSS),$(a).removeAttr("data-form-type")):($(a).parent().find("label").attr("class",validations.showCSS),$(a).attr("data-form-type","true"))},validationinterface:function(a){switch(a.contenttype){case"email":this.emailvalidation(a.content);break;case"number":this.numbervalidation(a.content);break;case"mobile":this.mobilevalidation(a.content);break;case"string":this.textvalidation(a.content);break;case"alphaNumericValidation":this.alphaNumericValidation(a.content);break;case"checkbox":this.checkboxvalidation(a.content);break;case"checkboxMulti":this.checkboxvalidationMulti(a.content);break;case"radio":this.radiovalidation(a.content);break;case"passwordvalidation":this.passwordvalidation(a.content);break;case"multiSelect":this.multiSelectValidation(a.content);break;case"date":this.datevalidation(a.content);break;default:this.genvalidation(a.content)}}};let datatransformutils={findAndRemove:function(a,t,e){a.forEach(function(i,n){i[t]===e&&a.splice(n,1)})},staticValsMapping:function(a,t){var e=validationmap.filter(t=>t.inputtypemod==a);if(!Array.isArray(e)||!e.length)return t;if(void 0!=e[0].childcontent){var i=t.includes(",")?t.split(","):t,n=[];return Array.isArray(i)&&i.length?(i.forEach(function(a){n.push(e[0].childcontent.filter(t=>t.val==a)[0].text)}),n.join(",")):e[0].childcontent.filter(a=>a.val==i)[0].text}},rename:function(a,t,e){return!!a.hasOwnProperty(t)&&(a[e]=a[t],delete a[t],!0)},removeJsonAttrs:function(a,t){return JSON.parse(JSON.stringify(a,function(a,e){return-1!==t.indexOf(a)?void 0:e}))},getCartesian:function(a){return Object.entries(a).reduce((a,[t,e])=>{var i=[];return a.forEach(a=>(Array.isArray(e)?e:[e]).forEach(e=>(e&&"object"==typeof e?datatransformutils.getCartesian(e):[e]).forEach(e=>i.push(Object.assign({},a,{[t]:e}))))),i},[{}])},flat:a=>a&&"object"==typeof a?Object.values(a).flatMap(datatransformutils.flat):a,getparentchildAR:function(a){var t=Object.keys(a[0])[0];return{[t]:a.map(a=>a[t])}},isNumberKey:function(a){var t=a.which?a.which:a.keyCode;return!(46!=t&&t>31&&(t<48||t>57))},editMultiSelect:function(a){var t=a.validationmap.filter(a=>"multiselect"==a.inputtype);a.content.map(function(e){return t.map(function(t){var i={};return a.multiselectfunc[t.inputtextval].destroy(t.inputtextval),-1!=e[t.inputCustomMapping].indexOf(",")?(isNaN(parseInt(e[t.inputname].split(",")[0]))?multiselects[t.inputname]=[{[t.inputtextval]:e[t.inputname].split(",")}]:multiselects[t.inputname]=[{[t.inputtextval]:e[t.inputname].split(",").map(Number)}],i[t.inputtextval]=e[t.inputCustomMapping].split(",").map(function(a,i){return{key:t.inputtextval,text:void 0!=t.childcontent?datatransformutils.staticValsMapping(t.inputCustomMapping,a):a,vals:isNaN(parseInt(e[t.inputname].split(",")[i]))?e[t.inputname].split(",")[i]:parseInt(e[t.inputname].split(",")[i])}})):(isNaN(parseInt(e[t.inputname]))?multiselects[t.inputname]=[{[t.inputtextval]:[e[t.inputname]]}]:multiselects[t.inputname]=[{[t.inputtextval]:[parseInt(e[t.inputname])]}],i[t.inputtextval]={key:t.inputtextval,text:void 0!=t.childcontent?datatransformutils.staticValsMapping(t.inputCustomMapping,e[t.inputCustomMapping]):e[t.inputCustomMapping],vals:isNaN(parseInt(e[t.inputname]))?e[t.inputname]:parseInt(e[t.inputname])}),i})})[0];t.forEach(function(t){var e=t.inputtextval;a.content[0][t.inputParent].forEach(function(t){a.multiselectfunc[e].onsearchtext(t)})})},getminusincrement:function(a,t){var e=[],i=parseInt(a-t);return[...Array(i).keys()].forEach(function(t){e.push(parseInt(a-=1))}),e},addArrayinJson:function(a,t,e){var i=[];i.push(e);var n={};n[t]=i;var s=a.filter(function(a){return Object.keys(a).find(a=>a==t)});return s.length>0?a=s.map(function(a){return a[t].push(e),a}):a.push(n),a}};const equijoin=(a,t,e,i,n)=>{const s=a.reduce((a,t)=>a.set(t[e],t),new Map);return t.map(a=>n(s.get(a[i]),a))};String.prototype.contains||(String.prototype.contains=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),Array.prototype.exclude=function(a){return this.filter(function(t){return a.indexOf(t)<0})},Array.prototype.remove=function(){for(var a,t,e=arguments,i=e.length;i&&this.length;)for(a=e[--i];-1!==(t=this.indexOf(a));)this.splice(t,1);return this},Array.prototype.moveUp=function(a,t){var e=this.indexOf(a),i=e-(t||1);if(-1===e)throw new Error("Element not found in array");i<0&&(i=0),this.splice(e,1),this.splice(i,0,a)},Array.prototype.remByVal=function(a){for(var t=0;t<this.length;t++)this[t]===a&&(this.splice(t,1),t--);return this};const doChunk=(a,t)=>a.reduce((a,e)=>(a.length&&a[a.length-1].length!==t?a[a.length-1].push(e):a.push([e]))&&a,[]);Array.prototype.forEach2=function(a){for(var t=this.length,e=0;e<t;e++)a(this[e],e)},Array.prototype.map2=function(a){for(var t=this.length,e=new Array(t),i=0;i<t;i++)e[i]=a(this[i],i);return e},$.fn.formToJSON=function(){var a={},t=function(a,e,i){var n=e.shift();0==e.length?function(a,t,e){null!=a[t]?(a[t].push||(a[t]=[a[t]]),e.includes("[")?(e=isNaN(parseInt(e))?e:parseInt(e),a[t].push(JSON.parse(e)[0])):a[t].push(e)):e.includes("[")?(e=isNaN(parseInt(e))?e:parseInt(e),a[t]=JSON.parse(e)):a[t]=e}(a,n,i):(null==a[n]&&(a[n]={}),t(a[n],e,i))};return this.each(function(e,i){var n=$(i).val()||"",s=i.id.replace(/:\d*/g,"").split(".");t(a,s,n)}),a},RegExp.escape=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};let cartesianProduct=function(a){return a.reduce(function(a,t){return a.map(function(a){return t.map(function(t){return a.concat(t)})}).reduce(function(a,t){return a.concat(t)},[])},[[]])},htmlpopulate={htmltablecount:function(a){$("#sptotalUsers").html(a.count)},highlightconsolidatesearch:function(){$("#basetable tr").children();var a=$("#txtconsolidatesearch").val();""!=a&&this.highlightTextinHtml(a)},htmlpopulatemodal:function(){$("#overlaycontent").html(" "),base.idstatus=!0;baseloadsegments.moduleattributepopulate();var a="";validationmap.forEach(function(t){var e="string"!=t.fieldvalidatename?t.fieldvalidatename:"string",i="string"!=t.fieldvalidatename?"onchange":"onkeyup";a+='<div class="form-group overlaytxtalign col-md-5"><div class="col-sm-15"><label class="lblhide" id="lblmsg'+t.inputname+'"><i class="fa fa-bell-o"></i> Input with warning</label><input type="'+e+'" data-key-type="'+t.inputname+'"  data-attribute="'+t.fieldvalidatename+'" class="form-control" maxLength="'+t.fieldmaxlength+'" data-form-type="false" '+i+'="javascript:reqopsValidate.formvalidation(this)" id="cltrl'+t.inputname+'" placeholder="'+t.inputname.replace("_"," ").capitalize()+'"></div></div>'});var t=' <input type="hidden" name="'+currentmoduleid+'" value="0" data-attribute="checkbox"  id="cltrl'+currentmoduleid+'"> <div class="form-group overlaytxtalign col-md-5"><div class="col-sm-offset-2 col-sm-15"><div><label>'+this.baseCheckbox;$("#overlaycontent").html(a+t)},baseCheckbox:'<div class="checkbox tablechk">\n     <label>\n     <input type="checkbox" id="cltrlrecordstate" data-form-type="true"  data-attribute="checkbox" onclick="javascript:tableops.onchk(this)" value=true> Remember me\n     <span class="checkbox-material">\n     </span> \n     </label>\n     </div>',htmlpopulatetableheader:function(){$("#basetable thead tr").html(""),base.idstatus=!0;var a="";applyfields.forEach(function(t){a+=' <th onclick="tableops.sort(this)" data-field-header="'+t+'"><span class=" sortorderasc fa fa-fw"></span>'+t.replace("_"," ").capitalize()+"</th>"}),$("#basetable thead tr").html('<th style="display:none;">ID</th><th style="width: 10%" ;><div class="checkbox tablechk"><label><input type="checkbox" id="tblselectallchk" onclick="javascript:tableops.tblselectall();"><span class="checkbox-material"></span> Check all</label></div></th>'+a)},htmlpopulatefilterbar:function(){basesearchar=[],$("#dvfilterbar  div.fieldsfilterbar").html(""),$("#dvfilterbar  div.fieldsfilterbarconsolidated").html(""),base.idstatus=!0;var a=applyfields,t="";a.forEach(function(a){var e=validationmap.filter(function(t){return t.inputtextval==a}).map(function(a){return a.inputname})[0];t+='<div style="display: inline-block;"><input type="text" style="width:45%;" class="form-control"data-multipleselect-autocomplete-key="'+(e=void 0!=e?e:a)+'" data-multipleselect-autocomplete="'+a+'" id="cltrl_filter_'+e+'" oninput="multiselect.searchbarautocomplete(this)" placeholder="'+a.replace("_"," ")+'"></div>'}),$("#dvfilterbar div.fieldsfilterbar").html(t),$("#dvfilterbar div.fieldsfilterbar").append('<div style="display: inline-block;"><div class="zoom-menu"><a class="zoom-fab zoom-btn-sm zoom-btn-report scale-transition" onclick="javascript:reqops.srchparams();"><i class="fa fa-bolt"></i></a></div></div>'),$("#dvfilterbar div.fieldsfilterbarconsolidated").append('<div style="display: inline-block;float:right;"><div class="input-group input-group-sm input-group-sm-override" style="width: 150px;"><div class="form-group "><input type="text" id="txtconsolidatesearch" name="table_search" class="form-control pull-right" placeholder="Search"></div><div class="input-group-btn"><button type="submit" onclick="javascript:reqops.consolidatesearch();" class="btn btn-default"><i class="fa fa-search"></i></button></div></div></div>'),$("#dvfilterbar div.fieldsfilterbarconsolidated").append('<div style="display: inline-block;float: right;padding-right: 30px;"><a class="zoom-fab zoom-btn-sm zoom-btn-report scale-transition" onclick="javascript:multiselect.fieldfilters(this)"><i class="fa fa-plus" ></i></a></div>'),a.forEach(function(a){a.includes("date")&&$("#cltrl_filter_birth_date").parent().remove()})},htmlpopulatetable:function(a){$("#basetable tbody").children().remove();var t=a.rows;a.count;if(t.length>0){console.log(base.pageno),$("#spcurrentPage").html(base.pageno),$("#sppageSize").html(base.pageSize),$("#sptotalUsers").html(a.count),base.idstatus=!1,base.excludedatecol=!1;var e=applyfields,i="";e.map(a=>Object.values(a)).toString();t=alasql("SELECT "+e+", "+[currentmoduleid]+" FROM ? ",[t]);var n=datatransformutils.removeJsonAttrs(t,["updated_date"]),o=(n=datatransformutils.removeJsonAttrs(n,["created_date"]),n=datatransformutils.removeJsonAttrs(n,["recordstate"]),Object.keys(n[0]).remove(currentmoduleid));for(s of t){$("#basetable tbody ").append("<tr>");var r='<div class="checkbox tablechk" ><label><input type="checkbox" data-chk-type="'+s[currentmoduleid]+'" class="tblkchk"  onclick="javascript:tableops.tablechkbox('+s[currentmoduleid]+')"><span class="checkbox-material"><span class="check"></span></span> </label></div>';for(f of($("#basetable tbody tr").last().append("<td>"+r+"</td>"),o))i=f.includes("date")?moment(s[f],"YYYY-MM-DD[T]HH:mm:ss").format("DD MMM YYYY"):s[f],isStaticMappingCheckpoint=validationmap.filter(a=>void 0!=a.childcontent).length<=0?i:datatransformutils.staticValsMapping(f,i),$("#basetable tbody tr").last().append("<td>"+isStaticMappingCheckpoint+"</td>");$("#basetable tbody tr").last().append('<td  data-tbledit-type="'+s[currentmoduleid]+'" onclick=javascript:reqops.ontdedit('+s[currentmoduleid]+")><a class='edithover' href='javascript:void(0);'>edit</a></td>")}}this.tblvisiblity(),basemod_modal.afterhtmlpopulate(),$("#divreportcontent").show()},tblvisiblity:function(){var a=$("#basetable thead th").length,t=$("#basetable tbody tr:eq(0) td").length;t>0&&datatransformutils.getminusincrement(t,a).forEach2(function(a){$("#basetable tbody tr td:nth-child("+a+")").hide()})},highlightTextinHtml:function(a,t){if(a){t=$("#basetable");var e=new RegExp("("+RegExp.escape(a)+")","gi"),i="<span class='highlightedsearch'>"+a+"</span>";$("*",t).contents().each(function(a,t){if(3===t.nodeType){var n=t.data;if(n=n.replace(e,i)){var s=$("<span>").html(n);$(t).before(s.contents()).remove()}}})}},dehighlightinHtml:function(a,t){var e=document.createTextNode(a);$("span.highlightedsearch",t).each(function(){this.parentNode.replaceChild(e.cloneNode(!1),this)})}},baseloadsegments={initialdatatableload:function(){filterparam.searchparam=["NA"],filterparam.searchtype="NoFilter",filterparam.daterange=base.searchdatefilter,base.pageno=void 0===base.pageno?0:base.pageno,base.pageSize=void 0===base.pageSize?20:base.pageSize,filterparam.pageno=base.pageno,filterparam.pageSize=base.pageSize,filterparam.datecolsearch=base.datecolsearch,base.datapayload=filterparam,$("#dvreportcontainer").show(),$("#dvparentfilterbar").show(),$("#dvreportcontainer").addClass("loading-report-container"),basefunction().getpaginatesearchtype(base).then(function(a){htmlpopulate.htmlpopulatetable(a),$("#dvreportcontainer").hasClass("collapsed-box")&&$("#rptwidget").click(),$("#dvreportcontainer").removeClass("loading-report-container"),basefunction().getpaginatesearchtypeCount(base).then(function(a){htmlpopulate.htmltablecount(a)})})},getapptoken:function(a){return basedataset.appkey=base.appkey,a.url=ajaxurl.auth,a.payload=basedataset,new Promise(function(t,e){ajaxutils.basepostmethod(a).then(baseloadsegments.setconfig).then(function(a){t(a)}).catch(function(a){console.log(a)})})},setconfig:function(a){return new Promise(function(t,e){ajaxbase.postauth.headers["x-access-token"]=a.token,t(ajaxbase)})},moduleattributepopulate:function(){var a=moduleattributes.split(",");(a.remove("updated_date").remove("created_date").remove("recordstate"),base.idstatus&&a.remove(currentmoduleid),base.excludedatecol)&&(a=a.filter(function(a){return!a.includes("date")}));return a},populateaxiskeys:function(){base.idstatus=!0,base.excludedatecol=!1,base.moduleattributes=applyfields,$("#selxaxis").append("<option></option>"),base.moduleattributes.forEach(function(a){$("#selxaxis").append("<option value = "+a+">"+a.replace("_"," ").capitalize()+"</option>")}),$("#selxaxis").select2({placeholder:"Select a horizontal ( xaxis ) paramaters",allowClear:!0}),$("#selyaxis").append("<option></option>"),base.moduleattributes.forEach(function(a){$("#selyaxis").append("<option value = "+a+">"+a.replace("_"," ").capitalize()+"</option>")}),$("#selyaxis").select2({placeholder:"Select a vertical ( yaxis ) paramaters",allowClear:!0});var a=moduleattributes.split(",").filter(function(a){return a.includes("date")}).filter(function(a){return!a.includes("update")});$("#seldatefields").append("<option></option>"),a.forEach(function(a){$("#seldatefields").append("<option value = "+a+">"+a.replace("_"," ").capitalize()+"</option>")}),$("#seldatefields").select2({placeholder:"Select date field",allowClear:!0}),$("#seldatefields").val("created_date"),$("#seldatefields").trigger("change")},basePopulateMultiControlsPopulate:function(a,t){return a.filter(function(a){return a.inputtypemod==t}).map(function(a){return a.inputtypeVal})[0]},basePopulateMultiControls:function(a){return{searchparam:[{[a]:""}],searchparamkey:a,searchtype:"Columnwise",searchparammetafilter:[],pageno:0,pageSize:20}}},pivotutils={pivotreport:function(){base.datapayload=payloadprepared(),basefunction().getpivotreport(base).then(function(a){pivotutils.processpivotresponse(a);var t=[];for(i=0;i<=base.tablecontent_rows.length-1;i++){var e=base.tablecontent_rows[i],n={};Object.keys(base.tablecontent_rows[i]).forEach(function(a){var t=e[a];n[a]=isNaN(parseInt(t))?0:parseInt(t)}),t.push(n),n={}}base.tablecontent_rows_consolidate=t,pivotutils.tblpivotyaxis(base),pivotutils.tblpivotxaxis(base),base.pivotinternload&&(base.internaxis.length-1!=base.Xtotalpivotrecorset?(basepagination.bootpaginationxaxis(base),$("#dvaxis").css("overflow-x","scroll"),$("#dvaxis").css("margin-top","0%")):$("#page-selection-xaxis").html(""),base.Ytotalpivotrecorset!=base.table_rows.length-1?(basepagination.bootpaginationyaxis(base),$("#dvaxis").css("overflow-x","scroll")):$("#page-selection-yaxis").html("")),initcharts(base.internaxis,base.yaxisarray),init3dcharts(base),pivotutils.drilldownpieparent(),$("#btnPivotDownload").show()})},drilldownpieparent:function(){var a=base.rawpivotdata.rows,t=a.filter(function(a){return"total"!==a.yaxis}).map(function(a){return{name:a.yaxis,y:parseInt(a.subtotal),drilldown:a.yaxis}}),e=a.filter(function(a){return"total"!==a.yaxis}).map(function(a){var t=Object.keys(a).filter(function(a){return"yaxis"!=a&&"subtotal"!=a}).map(function(t){var e=[];return e.push(t),e.push(null===a[t]?0:parseInt(a[t])),e});return{name:a.yaxis,id:a.yaxis,data:t}});base.parentdrilldown=t,base.childrendrilldown=e,populatepiechart(base)},tblpivotyaxis:function(a){var t=a.table_cols,e=a.table_rows;for(f of($("#tblpivotcol thead").html(" "),$("#tblpivotcol tbody").html(" "),$("#tblpivotcol thead ").append("<tr>"),t))$("#tblpivotcol thead tr").last().append("<th>"+f+"</th>").fadeIn("slow");for(s of e)for(f of($("#tblpivotcol tbody ").append("<tr>"),t))$("#tblpivotcol tbody tr").last().append("<td>"+s[f]+"</td>").fadeIn("slow")},tblpivotxaxis:function(a){var t=a.tablecontent_cols,e=a.tablecontent_rows_consolidate;for(f of($("#tblpivotxaxis thead").html(" "),$("#tblpivotxaxis tbody").html(" "),$("#tblpivotxaxis thead ").append("<tr>"),t))$("#tblpivotxaxis thead tr").last().append("<th>"+f+"</th>").fadeIn("slow");for(s of e)for(f of($("#tblpivotxaxis tbody ").append("<tr>"),t))$("#tblpivotxaxis tbody tr").last().append("<td>"+s[f]+"</td>").fadeIn("slow")},processpivotresponse:function(a){var t=a;if(base.rawpivotdata=a,t.rows.length>0){var e=datatransformutils.removeJsonAttrs(t.rows,["interncolumn"]),i=datatransformutils.removeJsonAttrs(t.rows,["interncolumn"]).map(function(a){return{Monthsegregation:a.yaxis}}),n=datatransformutils.removeJsonAttrs(e,["yaxis"]),s=[],o={};for(index=0;index<n.length;++index){var r=n[index],l=Object.keys(r).filter(a=>"subtotal"!=a).map(function(a){return isNaN(parseInt(r[a]))?0:parseInt(r[a])});o.name=i[index].Monthsegregation,o.data=l,s.push(o),o={}}var c=Object.keys(n[0]);base.internaxis=c,base.yaxisarray=s,base.table_rows=i,base.table_cols=Object.keys(i[0]),base.tablecontent_rows=n,base.tablecontent_cols=Object.keys(n[0]),base.Xtotalpivotrecorset=t.Xcount,base.Ytotalpivotrecorset=t.Ycount,base.subtotal=t.totaldoc}},setselxaxis:function(){base.pivotparamXaxis=$("#selxaxis").val();var a=base.pivotparamXaxis;base.Ypageno=0,base.Xpageno=0,base.pivotinternload=!0,a.includes("date")?($("#chkprimary").css("visibility","visible"),$("#chkprimary").css("height","")):($("#chkprimary").css("visibility","hidden"),$(".rptbasediv").css("height","10px"),base.timeinternsecondary="")},setselyaxis:function(){base.pivotparamYaxis=$("#selyaxis").val(),base.Ypageno=0,base.Xpageno=0,base.pivotinternload=!0,base.pivotparamYaxis.includes("date")?$("#chksecondary").css("visibility","visible"):($("#chksecondary").css("visibility","hidden"),base.timeinternprimary="")},setseldatefields:function(){base.datecolsearch=$("#seldatefields").val(),$(".topdatepicker").show()},exportexcelPivot:function(){var a=Papa.unparse(base.rawpivotdata.rows),t=currentmodulename+".csv",e=new Blob([a],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(e,t);else{var i=document.createElement("a");i.href=window.URL.createObjectURL(e),i.setAttribute("download",t),document.body.appendChild(i),i.click(),document.body.removeChild(i)}}};